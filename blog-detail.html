<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Detail</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="navbar">
        <a href="index.html"><img src="./assets/logo.png" alt="logo" width="100"></a>
        <a href="index.html" class="nav-item">Home</a>
        <a href="about.html" class="nav-item">About</a>
        <input id="searchInput" type="text" placeholder="Search..." onkeydown="handleSearch(event)">
        <button onclick="clearSearch()" id="clearButton">Clear</button>
    </div>

    <!-- Blog Detail Container -->
    <div id="blogDetail"></div>

    <!-- Related Blogs Container -->
    <div id="relatedBlogs"></div>

    <!-- Search Results Container -->
    <div id="searchResults" style="display: none;"></div>

    <script src="data.js"></script>
    <script src="blog-detail.js"></script>
    <script>
        const params = new URLSearchParams(window.location.search);
        const blogId = params.get('id');
        const blog = data.posts.find(post => post.id == blogId);

        const blogDetailContainer = document.getElementById("blogDetail");
        const relatedBlogsContainer = document.getElementById("relatedBlogs");
        const searchResultsContainer = document.getElementById("searchResults");

        function renderBlogDetails(blog) {
            if (blog) {
                blogDetailContainer.innerHTML = `
                    <h1>${blog.title}</h1>
                    <p>by ${blog.author} on ${new Date(blog.date).toLocaleDateString()}</p>
                    <img src="${blog.img}" alt="${blog.title}" class="blog-detail-image">
                    <p>${blog.content}</p>
                    <div><strong>Tags:</strong> ${blog.tags.join(", ")}</div>
                `;

                const relatedBlogs = data.posts.filter(post => post.category === blog.category && post.id != blog.id);
                if (relatedBlogs.length > 0) {
                    relatedBlogsContainer.innerHTML = `
                        <h2>Related Blogs</h2>
                        <div class="related-blogs-container">
                            ${relatedBlogs.map(relatedBlog => `
                                <div class="related-blog">
                                    <a href="blog-detail.html?id=${relatedBlog.id}">
                                        <img src="${relatedBlog.img}" alt="${relatedBlog.title}">
                                        <h3>${relatedBlog.title}</h3>
                                        <p>by ${relatedBlog.author} on ${new Date(relatedBlog.date).toLocaleDateString()}</p>
                                        <p>${relatedBlog.content.slice(0, 90)}...</p>
                                    </a>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else {
                    relatedBlogsContainer.innerHTML = "<p>No related blogs available.</p>";
                }
            } else {
                blogDetailContainer.innerHTML = "<p>Blog not found.</p>";
            }
        }

        function renderSearchResults(blogs) {
            searchResultsContainer.style.display = "block";
            blogDetailContainer.style.display = "none";
            relatedBlogsContainer.style.display = "none";

            searchResultsContainer.innerHTML = blogs.length
                ? blogs.map(blog => `
                    <div class="blog-item">
                        <a href="blog-detail.html?id=${blog.id}">
                            <img src="${blog.img}" alt="Blog image" class="blog-image">
                            <h2>${blog.title}</h2>
                            <p>${blog.content.slice(0, 90)}...</p>
                        </a>
                    </div>
                `).join('')
                : "<img src='assets/NotFound.gif' width='100vw' height='80vh'></img>";
        }

        // Show blog details by default
        renderBlogDetails(blog);
    </script>
</body>
</html>
